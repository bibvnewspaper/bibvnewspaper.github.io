---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

const articles = (await getCollection("articles"))
  .filter((article) => !article.data.draft)
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());

const formatDate = (date) =>
  new Intl.DateTimeFormat("en-US", {
    month: "long",
    day: "numeric",
    year: "numeric",
  }).format(date);
---

<BaseLayout title="Articles | On a MONTHLY BASIS" description="All articles.">
  <section class="hero">
    <div class="eyebrow">Archive</div>
    <h1>Articles</h1>
    <p>All published stories and features.</p>
  </section>

  <section class="issues">
    {articles.map((article) => (
      <article class="issue-card">
        <div class="eyebrow">{article.data.issue}</div>
        <h3>{article.data.title}</h3>
        <p>{article.data.summary}</p>
        <div class="article-meta">
          <span>{formatDate(article.data.date)}</span>
          <a class="button" href={`/articles/${article.slug}`}>Read</a>
        </div>
      </article>
    ))}
  </section>
</BaseLayout>
