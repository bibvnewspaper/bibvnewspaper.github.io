---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

const issues = (await getCollection("issues"))
  .filter((issue) => !issue.data.draft)
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());

const formatDate = (date) =>
  new Intl.DateTimeFormat("en-US", {
    month: "long",
    day: "numeric",
    year: "numeric",
  }).format(date);
---

<BaseLayout title="Archives | On a MONTHLY BASIS" description="Previous issues.">
  <section class="hero">
    <div class="eyebrow">Archive</div>
    <h1>Archives</h1>
    <p>All published issues.</p>
  </section>

  <section class="issues">
    {issues.map((issue) => (
      <article class="issue-card">
        <div class="eyebrow">{issue.data.issue}</div>
        <h3>{issue.data.title}</h3>
        <p>{issue.data.summary}</p>
        <div class="article-meta card">
          <span>{formatDate(issue.data.date)}</span>
          <a class="button" href={`/issues/${issue.slug}`}>Read</a>
        </div>
      </article>
    ))}
  </section>
</BaseLayout>
