---
import BaseLayout from "../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

const allIssues = (await getCollection("issues"))
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());

const latest = allIssues[0];

const formatDate = (date) =>
  new Intl.DateTimeFormat("en-US", {
    month: "long",
    day: "numeric",
    year: "numeric",
  }).format(date);
---

<BaseLayout
  title="On a Monthly BASIS Newspaper"
  description="BASIS Independent Bellevue student newspaper featuring monthly stories, interviews, and features."
>
  <section class="hero hero-home">
    <div class="hero-copy">
      <div class="eyebrow">BASIS Independent Bellevue</div>
      <h1>On a <i>Monthly</i> BASIS</h1>
      <p>
        We Are <i>On A Monthly BASIS</i>. Welcome to our Github site!
      </p>
    </div>
    <figure class="hero-logo" aria-label="On a Monthly Basis newspaper logo">
      <img src="/images/logo-all.png" alt="On a MONTHLY BASIS logo" loading="eager" />
    </figure>
  </section>

  <section class="panel">
    <h2 class="section-title">Latest Release</h2>
    {latest ? (
      <div class="issue-card">
        <div class="eyebrow">{latest.data.issue}</div>
        <h3>{latest.data.title}</h3>
        <p>{latest.data.summary}</p>
        <div class="article-meta card">
          <span>{formatDate(latest.data.date)}</span>
          <a class="button" href={`/issues/${latest.slug}`}>Read</a>
        </div>
      </div>
    ) : (
      <p>No releases yet. Add your first issue in `src/content/issues`.</p>
    )}
  </section>

  <section class="panel">
    <h2 class="section-title">Notes</h2>
    <p>
      For contributors, please put new MDX files into
      <code>src/content/articles</code>; after committing they will appear on the site.
    </p>
  </section>
</BaseLayout>
